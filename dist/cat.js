(()=>{"use strict";new class{constructor(){this.nekoEl=document.createElement("div"),this.isReduced=window.matchMedia("(prefers-reduced-motion: reduce)")&&!0===window.matchMedia("(prefers-reduced-motion: reduce)").matches,this.nekoPosX=32,this.nekoPosY=32,this.mousePosX=0,this.mousePosY=0,this.frameCount=0,this.idleTime=0,this.idleAnimation=null,this.idleAnimationFrame=0,this.avalibleIdleAnimations=["sleeping","scratchSelf"],this.nekoSpeed=10,this.spriteSets={idle:[[-3,-3]],alert:[[-7,-3]],scratchSelf:[[-5,0],[-6,0],[-7,0]],scratchWallN:[[0,0],[0,-1]],scratchWallS:[[-7,-1],[-6,-2]],scratchWallE:[[-2,-2],[-2,-3]],scratchWallW:[[-4,0],[-4,-1]],tired:[[-3,-2]],sleeping:[[-2,0],[-2,-1]],N:[[-1,-2],[-1,-3]],NE:[[0,-2],[0,-3]],E:[[-3,0],[-3,-1]],SE:[[-5,-1],[-5,-2]],S:[[-6,-3],[-7,-2]],SW:[[-5,-3],[-6,-1]],W:[[-4,-2],[-4,-3]],NW:[[-1,0],[-1,-1]]},this.isReduced||(console.log(this.setSprite),this.create())}create(){this.nekoEl.id="oneko",this.nekoEl.style.width="32px",this.nekoEl.style.height="32px",this.nekoEl.style.position="fixed",this.nekoEl.style.pointerEvents="none",this.nekoEl.style.backgroundImage="url('./oneko.gif')",this.nekoEl.style.imageRendering="pixelated",this.nekoEl.style.left=this.nekoPosX-16+"px",this.nekoEl.style.top=this.nekoPosY-16+"px",this.nekoEl.style.zIndex=""+Number.MAX_VALUE,document.body.appendChild(this.nekoEl),document.onmousemove=e=>{this.mousePosX=e.clientX,this.mousePosY=e.clientY},window.onekoInterval=setInterval(this.frame,100)}setSprite(e,i){const t=this.spriteSets[e][i%this.spriteSets[e].length];this.nekoEl.style.backgroundPosition=`${32*t[0]}px ${32*t[1]}px`}resetIdleAnimation(){this.idleAnimation=null,this.idleAnimationFrame=0}idle(){switch(this.idleTime+=1,this.idleTime>10&&0==Math.floor(200*Math.random())&&null==this.idleAnimation&&(this.nekoPosX<32&&this.avalibleIdleAnimations.push("scratchWallW"),this.nekoPosY<32&&this.avalibleIdleAnimations.push("scratchWallN"),this.nekoPosX>window.innerWidth-32&&this.avalibleIdleAnimations.push("scratchWallE"),this.nekoPosY>window.innerHeight-32&&this.avalibleIdleAnimations.push("scratchWallS"),this.idleAnimation=this.avalibleIdleAnimations[Math.floor(Math.random()*this.avalibleIdleAnimations.length)]),this.idleAnimation){case"sleeping":if(this.idleAnimationFrame<8){this.setSprite("tired",0);break}this.setSprite("sleeping",Math.floor(this.idleAnimationFrame/4)),this.idleAnimationFrame>192&&this.resetIdleAnimation();break;case"scratchWallN":case"scratchWallS":case"scratchWallE":case"scratchWallW":case"scratchSelf":this.setSprite(this.idleAnimation,this.idleAnimationFrame),this.idleAnimationFrame>9&&this.resetIdleAnimation();break;default:return void this.setSprite("idle",0)}this.idleAnimationFrame+=1}frame(){this.frameCount+=1;const e=this.nekoPosX-this.mousePosX,i=this.nekoPosY-this.mousePosY,t=Math.sqrt(Math.pow(e,2)+Math.pow(i,2));if(t<this.nekoSpeed||t<48)return void this.idle();if(this.idleAnimation=null,this.idleAnimationFrame=0,this.idleTime>1)return this.setSprite("alert",0),this.idleTime=Math.min(this.idleTime,7),void(this.idleTime-=1);let s;s=i/t>.5?"N":"",s+=i/t<-.5?"S":"",s+=e/t>.5?"W":"",s+=e/t<-.5?"E":"",this.setSprite(s,this.frameCount),this.nekoPosX-=e/t*this.nekoSpeed,this.nekoPosY-=i/t*this.nekoSpeed,this.nekoPosX=Math.min(Math.max(16,this.nekoPosX),window.innerWidth-16),this.nekoPosY=Math.min(Math.max(16,this.nekoPosY),window.innerHeight-16),this.nekoEl.style.left=this.nekoPosX-16+"px",this.nekoEl.style.top=this.nekoPosY-16+"px"}}})();